simulate_individual <- function(theta, infectionHistory,
                                samples, samplingTimes,
                                strainIsolationTimes,
                                antigenicMapLong, antigenicMapShort){
    dat <- matrix(ncol=2, nrow=length(samplingTimes)*length(infectionHistory))
    titres <- NULL
    for(i in 1:length(samplingTimes)){
        if(samples[i] > 0){
            y <- infection_model_indiv(theta, infectionHistory, samplingTimes[i],
                                       strainIsolationTimes, antigenicMapLong, antigenicMapShort)
            titres <- c(titres, y)
        } else {
            titres <- c(titres, rep(NA, length(strainIsolationTimes)))
        }
        dates <- c(dates, rep(samplingTimes[i],length(strainIsolationTimes)))
    }
    dat[,1] <- dates
    dat[,2] <- titres
    return(dat)
        
}

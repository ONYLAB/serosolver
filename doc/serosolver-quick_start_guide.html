<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Serosolver: Quick Start Guide</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Serosolver: Quick Start Guide</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In disease systems where a single infection is expected in a given period of time, serological data can be combined with models of antibody kinetics to infer past infection times and the force of infection on a population <span class="citation">[1–4]</span>. However, simple models of antibody kinetics are often incomplete for viruses, such as influenza outside of a single season, due to the antigenically variable nature of the virus. Whereas raised antibody titres against a pathogen with a single circulating phenotype are indicative of infection, cross-reactive antibodies from antigenically similar influenza viruses results in a measurable antibody response against strains that an individual may not have seen <span class="citation">[5–7]</span>. Understanding the immunological processes which build an individual’s antibody repertoire is further complicated by the interference of a pre-existing memory B cell response on the production of new B cell populations against the infecting strain <span class="citation">[8,9]</span>.</p>
<p>Progress has been made in understanding the immunological mechanisms which link observed immune responses with disease incidence through experimental systems and human population studies <span class="citation">[10–14]</span>. Taking into account phenomena such as original antigenic sin (OAS), antigenic seniority, back-boosting and age-specific antibody responses have been used to significantly improve our interpretation of serological data <span class="citation">[15–18]</span>. The full repertoire of humoral responses by one individual to all previous and future strains can be described by an antibody landscape, which quantifies the expected antibody titre against viruses on an antigenic map <span class="citation">[17]</span>. Quantifying these mechanisms, along with antibody boosting and cross reactivity, can therefore be used to better predict antibody landscapes for humans <span class="citation">[19]</span>.</p>
<div id="model-description" class="section level3">
<h3>Model Description</h3>
<p><code>serosolver</code> uses a dynamic model of antibody dynamics, previously described by Kucharski <em>et al.</em> <span class="citation">[20]</span> to infer infection histories and attack rates from cross-sectional or longitudinal serological data. The model infers individual infection histories, historical attack rates, and patterns of antibody dynamics by accounting for short-term, broadly reactive antibody boosting following exposure; long-term, narrowly-reactive antibody boosting; boosting suppression through antigenic seniority; and measurement error.</p>
</div>
<div id="vignette-outline" class="section level3">
<h3>Vignette Outline</h3>
<p>This quick start guide is designed to provide the basic instructions to use <code>serosolver</code> on serological data. For more in depth instructions about the different capabilities of <code>serosolver</code> see the case study vignettes.The following steps are covered in this guide:</p>
<ol style="list-style-type: decimal">
<li>Formatting and inputting a serological data set</li>
<li>Specifying inputs
<ul>
<li>Parameter values</li>
<li>Antigenic map</li>
<li>Age mask</li>
<li>Starting infection histories</li>
</ul></li>
<li>Running MCMC</li>
<li>Processing outputs and generating plots</li>
</ol>
</div>
</div>
<div id="install-serosolver" class="section level2">
<h2>Install serosolver</h2>
<p>The easiest way to install the development version of <code>serosolver</code> is to use the <code>devtools</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#devtools::install_github(&quot;seroanalytics/serosolver&quot;)</span>
<span class="kw">library</span>(serosolver)
<span class="kw">library</span>(plyr)
<span class="kw">library</span>(data.table)
<span class="kw">library</span>(ggplot2)</code></pre></div>
</div>
<div id="data-format" class="section level2">
<h2>1: Data Format</h2>
<p><code>serosolver</code> expects a data frame as input in long format with the following columns:</p>
<ol style="list-style-type: decimal">
<li>individual: consecutive integer ID of individuals from <span class="math inline">\(1,\dots,N\)</span>, where <span class="math inline">\(N\)</span> is the total number of individuals</li>
<li>samples: integer value of the time each sample was collected
<ul>
<li>For annual samples, the sample time is simply the year each sample was collected in. For example, data collected between 2009 and 2011 would have values of 2009, 2010, or 2011.</li>
<li>For semi-annual samples, the sample time is the year the sample was collected multiplied by 2 (since there are two semesters in every year). For example, data collected between 2009 and 2011 would have values of <span class="math inline">\((2009 \times 2) + 1 = 4019\)</span>, <span class="math inline">\((2009.5 \times 2) + 1 = 4020\)</span>, <span class="math inline">\((2010 \times 2) + 1 = 4021\)</span>, <span class="math inline">\((2010.5 \times 2) + 1 = 4022\)</span>, <span class="math inline">\((2011 \times 2) + 1 = 4023\)</span>, <span class="math inline">\((2011.5 \times 2) + 1 = 4024\)</span>.</li>
<li>Similarly, for quarterly or monthly samples, the sample time follows the same pattern. For example for a sample collected in July of 2009, the quarterly sample time would be <span class="math inline">\((2009.75 \times 4) + 1 = 8040\)</span> (because July is in the third quarter of the year) and the monthly sample time would be <span class="math inline">\((2009.5833 \times 12) + 1 = 24116\)</span> (because July is the seventh month and <span class="math inline">\(7/12=0.5833\)</span>).<br />
</li>
</ul></li>
<li>virus: numeric time of when the virus was circulating (should be in the same format as samples)</li>
<li>titre: integer of titre value against the given virus at that sampling time (needs to be on log scale)</li>
<li>run: integer value of the repeat number of each sample (if there are no repeat samples, then run should be 1 for every sample)</li>
<li>DOB: integer value of date of birth (should be in the same format as samples)</li>
<li>group: integer value giving the population membership of the individual</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  titre_dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">individual=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">4</span>)),
                          <span class="dt">samples=</span><span class="kw">c</span>(<span class="dv">8039</span>,<span class="dv">8040</span>,<span class="dv">8044</span>,<span class="dv">8047</span>,<span class="dv">8039</span>,<span class="dv">8041</span>,<span class="dv">8045</span>,<span class="dv">8048</span>),
                          <span class="dt">virus=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">8036</span>,<span class="dv">8</span>)),
                          <span class="dt">titre=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>),
                          <span class="dt">run=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">8</span>)),
                          <span class="dt">DOB=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">8036</span>,<span class="dv">8</span>)),
                          <span class="dt">group=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">8</span>))
                         )
  knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(titre_dat))</code></pre></div>
<p>For the remainder of this quick start guide we refer to the input data set as <code>titre_dat</code>.</p>
</div>
<div id="specifying-inputs" class="section level2">
<h2>2: Specifying inputs</h2>
<p>Along with a data file, serosolver expects several additional inputs namely, a parameter input file for starting values of antibody kinetics parameters, an antigenic map, an age mask, and starting infection histories. The following section will walk the users through creating each of these inputs.</p>
<div id="parameter-values" class="section level3">
<h3>Parameter values</h3>
<p>Several input files are stored within the <code>serosolver</code> package in the ‘inputs’ directory, however users can create their own. The default parameter file ‘parTab_base.csv’ is shown below:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">names</th>
<th align="right">values</th>
<th align="right">fixed</th>
<th align="right">steps</th>
<th align="right">lower_bound</th>
<th align="right">upper_bound</th>
<th align="right">lower_start</th>
<th align="right">upper_start</th>
<th align="right">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="left">mu</td>
<td align="right">1.80</td>
<td align="right">0</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">1.00</td>
<td align="right">3.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>2</td>
<td align="left">mu_short</td>
<td align="right">2.70</td>
<td align="right">0</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">2.00</td>
<td align="right">3.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>3</td>
<td align="left">tau</td>
<td align="right">0.05</td>
<td align="right">0</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.01</td>
<td align="right">0.1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>4</td>
<td align="left">wane</td>
<td align="right">0.20</td>
<td align="right">0</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.01</td>
<td align="right">0.1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>5</td>
<td align="left">sigma1</td>
<td align="right">0.10</td>
<td align="right">0</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.10</td>
<td align="right">0.2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>6</td>
<td align="left">sigma2</td>
<td align="right">0.03</td>
<td align="right">0</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.01</td>
<td align="right">0.1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>7</td>
<td align="left">MAX_TITRE</td>
<td align="right">8.00</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8.00</td>
<td align="right">8.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>8</td>
<td align="left">error</td>
<td align="right">1.00</td>
<td align="right">0</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">25</td>
<td align="right">0.50</td>
<td align="right">2.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>9</td>
<td align="left">alpha</td>
<td align="right">1.00</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1000</td>
<td align="right">0.00</td>
<td align="right">1000.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>10</td>
<td align="left">beta</td>
<td align="right">1.00</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1000</td>
<td align="right">0.00</td>
<td align="right">1000.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>11</td>
<td align="left">kappa</td>
<td align="right">0.90</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.80</td>
<td align="right">1.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>12</td>
<td align="left">t_change</td>
<td align="right">6.00</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">12</td>
<td align="right">0.40</td>
<td align="right">12.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>13</td>
<td align="left">boost_limit</td>
<td align="right">6.00</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0.00</td>
<td align="right">8.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>14</td>
<td align="left">gradient</td>
<td align="right">0.20</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.00</td>
<td align="right">1.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>15</td>
<td align="left">titre_dependent</td>
<td align="right">0.00</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.00</td>
<td align="right">1.0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>16</td>
<td align="left">wane_type</td>
<td align="right">0.00</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">1.0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>18</td>
<td align="left">mu_mean</td>
<td align="right">2.00</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">-100</td>
<td align="right">100</td>
<td align="right">1.00</td>
<td align="right">3.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>19</td>
<td align="left">mu_sd</td>
<td align="right">0.50</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">1000</td>
<td align="right">0.10</td>
<td align="right">1.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>20</td>
<td align="left">rho_mean</td>
<td align="right">0.00</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">-10</td>
<td align="right">10</td>
<td align="right">-2.00</td>
<td align="right">2.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>21</td>
<td align="left">rho_sd</td>
<td align="right">1.00</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">1.00</td>
<td align="right">2.0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>In the parameter file, the column ‘fixed’ indicates if each parameter value is fixed or should be estimated. For values that are not fixed, starting values need to be generated. The below code generates a random starting value for unfixed parameter values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># generate starting parameter values</span>
  start_tab &lt;-<span class="st"> </span>par_tab
    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(start_tab)){
      <span class="cf">if</span>(start_tab[i,<span class="st">&quot;fixed&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){
        start_tab[i,<span class="st">&quot;values&quot;</span>] &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,start_tab[i,<span class="st">&quot;lower_start&quot;</span>], 
                                  start_tab[i,<span class="st">&quot;upper_start&quot;</span>])
      }
    }</code></pre></div>
</div>
<div id="antigenic-map" class="section level3">
<h3>Antigenic Map</h3>
<p>The antigenic map specifies the coordinates of different circulating viruses in antigenic space <span class="citation">[21]</span>, informing the model about how antigenically similar these viruses are. Viruses that are further apart in this 2-dimensional space are expected to cross react less than viruses that are close together.</p>
<p>An antigenic map can be created using <code>generate_antigenic_map()</code> and input by the user depending on the source of their data. We use the antigenic map created by Fonville <em>et al.</em> <span class="citation">[17]</span> in our analyses.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Read in raw coordinates
  antigenic_coords_path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;fonville_map_approx.csv&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;serosolver&quot;</span>)
  antigenic_coords &lt;-<span class="st"> </span><span class="kw">read.csv</span>(antigenic_coords_path, <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)

## Convert to form expected by serosolver
  antigenic_map &lt;-<span class="st"> </span><span class="kw">generate_antigenic_map</span>(antigenic_coords, <span class="dt">buckets =</span> <span class="dv">4</span>)

<span class="co"># unique strain circulation times</span>
  strains_isolation_times &lt;-<span class="st"> </span><span class="kw">unique</span>(antigenic_map<span class="op">$</span>inf_times)</code></pre></div>
</div>
<div id="age-mask" class="section level3">
<h3>Age Mask</h3>
<p>An age mask is required to indicate when each individual could have had their first infection. For example an individual born in 1997 could not have been infected with a strain that circulated in 1990. The function <code>create_age_mask()</code> outputs a vector of indices of the first <code>strains_isolation_times</code> that an individual could have been infected with.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  unique_indiv &lt;-<span class="st"> </span>titre_dat[<span class="op">!</span><span class="kw">duplicated</span>(titre_dat<span class="op">$</span>individual),]
  ageMask &lt;-<span class="st"> </span><span class="kw">create_age_mask</span>(unique_indiv<span class="op">$</span>DOB, strains_isolation_times)</code></pre></div>
<p>The final inputs required by <code>serosolver</code> are starting infection histories for each individual. The function <code>setup_infection_histories_new_2()</code> creates a matrix of infection histories given a matrix of titre data by looking at an individual’s titre against each strain. Where titres are raised, it suggests an infection. In this way, it can propose plausible initial infection histories from which to begin MCMC sampling.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  start_inf &lt;-<span class="st"> </span><span class="kw">setup_infection_histories_new_2</span>(titre_dat, strains_isolation_times)</code></pre></div>
</div>
</div>
<div id="run-mcmc" class="section level2">
<h2>3: Run MCMC</h2>
<p><code>seroslver</code> uses an Adaptive Metropolis-within-Gibbs algorithm. Given a starting point and the necessary MCMC parameters, <code>run_MCMC()</code> performs a random-walk of the posterior space to produce an MCMC chain that can be used to generate MCMC density and iteration plots (see section 4).</p>
<p>Using the default options, the MCMC can be run using the following.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># run MCMC  </span>
  res &lt;-<span class="st"> </span><span class="kw">run_MCMC</span>(<span class="dt">par_tab =</span> start_tab, <span class="dt">titre_dat =</span> titre_dat, <span class="dt">antigenic_map =</span> antigenic_map, 
                  <span class="dt">start_inf_hist =</span> start_inf, <span class="dt">CREATE_POSTERIOR_FUNC =</span> create_posterior_func,
                  <span class="dt">version =</span> <span class="dv">2</span>)</code></pre></div>
<p>If you want to change any default options, such as increasing or decreasing the number of iterations and the adaptive period you can pass a vector of function argument values to <code>run_MCMC()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  mcmc_pars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;iterations&quot;</span>=<span class="dv">50000</span>,<span class="st">&quot;popt&quot;</span>=<span class="fl">0.44</span>,<span class="st">&quot;popt_hist&quot;</span>=<span class="fl">0.44</span>,
                <span class="st">&quot;opt_freq&quot;</span>=<span class="dv">1000</span>,<span class="st">&quot;thin&quot;</span>=<span class="dv">1</span>,
                <span class="st">&quot;adaptive_period&quot;</span>=<span class="dv">10000</span>, <span class="st">&quot;save_block&quot;</span>=<span class="dv">1000</span>, 
                <span class="st">&quot;thin_hist&quot;</span>=<span class="dv">10</span>, <span class="st">&quot;hist_sample_prob&quot;</span>=<span class="fl">0.5</span>,
                <span class="st">&quot;switch_sample&quot;</span>=<span class="dv">2</span>, <span class="st">&quot;inf_propn&quot;</span>=<span class="fl">0.5</span>, 
                <span class="st">&quot;move_size&quot;</span>=<span class="dv">5</span>, <span class="st">&quot;hist_opt&quot;</span>=<span class="dv">0</span>,
                <span class="st">&quot;swap_propn&quot;</span>=<span class="fl">0.5</span>,<span class="st">&quot;hist_switch_prob&quot;</span>=<span class="fl">0.5</span>,
                <span class="st">&quot;year_swap_propn&quot;</span>=<span class="fl">0.5</span>)
  res &lt;-<span class="st"> </span><span class="kw">run_MCMC</span>(<span class="dt">par_tab =</span> start_tab, <span class="dt">titre_dat =</span> titre_dat, <span class="dt">antigenic_map =</span> antigenic_map, 
                <span class="dt">mcmc_pars =</span> mcmc_pars, <span class="dt">start_inf_hist =</span> start_inf,
                <span class="dt">CREATE_POSTERIOR_FUNC =</span> create_posterior_func, <span class="dt">version =</span> <span class="dv">2</span>)</code></pre></div>
</div>
<div id="processing-outputs" class="section level2">
<h2>4: Processing Outputs</h2>
<p><code>serosolver</code> contains numerous plotting functions for visualising results and evaluating model performance. Below are examples of several useful plotting functions.</p>
<div id="diagnostic-plots" class="section level3">
<h3>Diagnostic plots</h3>
<p>To evaluate model performance, trace and density plots can be produced by plotting the MCMC chains. In the below example the adaptive period and burn-in from the MCMC are excluded in the diagnostic plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Density/trace plots</span>
chain1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(res<span class="op">$</span>chain_file)
chain1 &lt;-<span class="st"> </span>chain1[chain1<span class="op">$</span>sampno <span class="op">&gt;=</span><span class="st"> </span>(mcmc_pars[<span class="st">&quot;adaptive_period&quot;</span>]<span class="op">+</span>mcmc_pars[<span class="st">&quot;burnin&quot;</span>]),]
<span class="kw">plot</span>(coda<span class="op">::</span><span class="kw">as.mcmc</span>(chain1[,<span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>,<span class="st">&quot;mu_short&quot;</span>,<span class="st">&quot;wane&quot;</span>)]))</code></pre></div>
</div>
<div id="results-plots" class="section level3">
<h3>Results plots</h3>
<p>Plot inferred attack rates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read in infection history file from MCMC output</span>
  inf_chain &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">fread</span>(res<span class="op">$</span>history_file,<span class="dt">data.table=</span><span class="ot">FALSE</span>)
<span class="co"># Remove adaptive period and burn-in</span>
  inf_chain &lt;-<span class="st"> </span>inf_chain[inf_chain<span class="op">$</span>sampno <span class="op">&gt;=</span><span class="st"> </span>(mcmc_pars[<span class="st">&quot;adaptive_period&quot;</span>]<span class="op">+</span>mcmc_pars[<span class="st">&quot;burnin&quot;</span>]),]
  inf_chain1 &lt;-<span class="st"> </span><span class="kw">setDT</span>(inf_chain)
<span class="co"># Define year range</span>
  xs &lt;-<span class="st"> </span><span class="kw">min</span>(strains_isolation_times)<span class="op">:</span><span class="kw">max</span>(strains_isolation_times)
<span class="co"># Plot inferred attack rates</span>
  arP &lt;-<span class="st"> </span><span class="kw">plot_attack_rates</span>(<span class="dt">infection_histories =</span> inf_chain1, <span class="dt">titre_dat =</span> titre_dat, <span class="dt">strain_isolation_times=</span>xs)</code></pre></div>
<p>Plot inferred infection histories.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot infection histories</span>
  IH_plot &lt;-<span class="st"> </span><span class="kw">plot_infection_histories</span>(<span class="dt">chain =</span> chain1, <span class="dt">infection_histories =</span> inf_chain, 
                                      <span class="dt">titre_dat =</span> titre_dat, <span class="dt">individuals =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>),
                                      <span class="dt">antigenic_map =</span> antigenic_map, <span class="dt">par_tab =</span> start_tab1)</code></pre></div>
<p>Plot inferred antibody titres.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot inferred antibody titres</span>
  titre_preds &lt;-<span class="st"> </span><span class="kw">get_titre_predictions</span>(<span class="dt">chain =</span> chain1, <span class="dt">infection_histories =</span> inf_chain, 
                                       <span class="dt">titre_dat =</span> titre_dat, <span class="dt">individuals =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>),
                                       <span class="dt">antigenic_map =</span> antigenic_map, <span class="dt">par_tab =</span> start_tab1)
  to_use &lt;-<span class="st"> </span>titre_preds<span class="op">$</span>predictions
  
  titre_pred_p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(to_use[to_use<span class="op">$</span>individual <span class="op">%in%</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,])<span class="op">+</span>
<span class="st">                  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>samples, <span class="dt">y=</span>median))<span class="op">+</span>
<span class="st">                  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>samples, <span class="dt">y=</span>titre))<span class="op">+</span>
<span class="st">                  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x=</span>samples,<span class="dt">ymin=</span>lower, <span class="dt">ymax=</span>upper),<span class="dt">alpha=</span><span class="fl">0.2</span>,<span class="dt">col=</span><span class="st">'red'</span>)<span class="op">+</span>
<span class="st">                  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>individual)</code></pre></div>
<p>Generate cumulative incidence plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  y &lt;-<span class="st"> </span><span class="kw">generate_cumulative_inf_plots</span>(inf_chain,<span class="dt">burnin =</span> <span class="dv">0</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dt">nsamp=</span><span class="dv">100</span>,
                                   <span class="dt">strain_isolation_times =</span> strain_isolation_times,
                                   <span class="dt">pad_chain=</span><span class="ot">FALSE</span>,<span class="dt">number_col =</span> <span class="dv">2</span>,<span class="dt">subset_years =</span> <span class="ot">NULL</span>)</code></pre></div>
</div>
<div id="parameter-estimates" class="section level3">
<h3>Parameter estimates</h3>
<p>The following code produces a table of the parameter estimates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Table of antibody kinetics parameters</span>
  myresults &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">3</span><span class="op">*</span><span class="dv">7</span>)),<span class="dt">nrow=</span><span class="dv">3</span>)
  <span class="kw">rownames</span>(myresults) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mu_short&quot;</span>,<span class="st">&quot;wane&quot;</span>,<span class="st">&quot;error&quot;</span>)
  <span class="kw">colnames</span>(myresults) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;sd&quot;</span>,<span class="st">&quot;2.5%&quot;</span>,<span class="st">&quot;25%&quot;</span>,<span class="st">&quot;50%&quot;</span>,<span class="st">&quot;75%&quot;</span>,<span class="st">&quot;97.5%&quot;</span>)
  
  myresults[,<span class="st">&quot;mean&quot;</span>] &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">apply</span>(chain1[,<span class="kw">c</span>(<span class="st">&quot;mu_short&quot;</span>,<span class="st">&quot;wane&quot;</span>,<span class="st">&quot;error&quot;</span>)],<span class="dv">2</span>,mean),<span class="dv">3</span>)
  myresults[,<span class="st">&quot;sd&quot;</span>] &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">apply</span>(chain1[,<span class="kw">c</span>(<span class="st">&quot;mu_short&quot;</span>,<span class="st">&quot;wane&quot;</span>,<span class="st">&quot;error&quot;</span>)],<span class="dv">2</span>,sd),<span class="dv">3</span>)  
  myresults[,<span class="dv">3</span><span class="op">:</span><span class="dv">7</span>] &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">round</span>(<span class="kw">apply</span>(chain1[,<span class="kw">c</span>(<span class="st">&quot;mu_short&quot;</span>,<span class="st">&quot;wane&quot;</span>,<span class="st">&quot;error&quot;</span>)],<span class="dv">2</span>,
                                   quantile,<span class="dt">probs=</span><span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>,<span class="fl">0.975</span>)),<span class="dv">3</span>))  </code></pre></div>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-white2014">
<p>1. White MT, Griffin JT, Akpogheneta O, Conway DJ, Koram KA, Riley EM, et al. Dynamics of the antibody response to Plasmodium falciparum infection in African children. J Infect Dis. 2014;210: 1115–1122. doi:<a href="https://doi.org/10.1093/infdis/jiu219">10.1093/infdis/jiu219</a></p>
</div>
<div id="ref-metcalf2016">
<p>2. Metcalf CJE, Farrar J, Cutts FT, Basta NE, Graham AL, Lessler J, et al. Use of serological surveys to generate key insights into the changing global landscape of infectious disease. Lancet. 2016;388: 728–730. doi:<a href="https://doi.org/10.1016/S0140-6736(16)30164-7">10.1016/S0140-6736(16)30164-7</a></p>
</div>
<div id="ref-borremans2016">
<p>3. Borremans B, Hens N, Beutels P, Leirs H, Reijniers J, Khan A, et al. Estimating Time of Infection Using Prior Serological and Individual Information Can Greatly Improve Incidence Estimation of Human and Wildlife Infections. Salathé M, editor. PLOS Comput Biol. Public Library of Science; 2016;12: e1004882. doi:<a href="https://doi.org/10.1371/journal.pcbi.1004882">10.1371/journal.pcbi.1004882</a></p>
</div>
<div id="ref-pepin2017">
<p>4. Pepin KM, Kay SL, Golas BD, Shriner SS, Gilbert AT, Miller RS, et al. Inferring infection hazard in wildlife populations by linking data across individual and population scales. Ecol Lett. 2017; doi:<a href="https://doi.org/10.1111/ele.12732">10.1111/ele.12732</a></p>
</div>
<div id="ref-beyer2004">
<p>5. Beyer WEP, Palache AM, Lüchters G, Nauta J, Osterhaus ADME. Seroprotection rate, mean fold increase, seroconversion rate: which parameter adequately expresses seroresponse to influenza vaccination? Virus Res. 2004;103: 125–32. doi:<a href="https://doi.org/10.1016/j.virusres.2004.02.024">10.1016/j.virusres.2004.02.024</a></p>
</div>
<div id="ref-tebeest2014">
<p>6. Beest D te, Bruin E de, Imholz S, Wallinga J, Teunis P, Koopmans M, et al. Discrimination of Influenza Infection (A/2009 H1N1) from Prior Exposure by Antibody Protein Microarray Analysis. Tang JW, editor. PLoS One. Cambridge University Press; 2014;9: e113021. doi:<a href="https://doi.org/10.1371/journal.pone.0113021">10.1371/journal.pone.0113021</a></p>
</div>
<div id="ref-freeman2016">
<p>7. Freeman G, Perera RAPM, Ngan E, Fang VJ, Cauchemez S, Ip DKM, et al. Quantifying homologous and heterologous antibody titre rises after influenza virus infection. Epidemiol Infect. 2016;144: 2306–2316. doi:<a href="https://doi.org/10.1017/S0950268816000583">10.1017/S0950268816000583</a></p>
</div>
<div id="ref-andrews2015">
<p>8. Andrews SF, Huang Y, Kaur K, Popova LI, Ho IY, Pauli NT, et al. Immune history profoundly affects broadly protective B cell responses to influenza. Sci Transl Med. 2015;7: 316ra192–316ra192. doi:<a href="https://doi.org/10.1126/scitranslmed.aad0522">10.1126/scitranslmed.aad0522</a></p>
</div>
<div id="ref-zarnitsyna2016">
<p>9. Zarnitsyna VI, Lavine J, Ellebedy A, Ahmed R, Antia R. Multi-epitope Models Explain How Pre-existing Antibodies Affect the Generation of Broadly Protective Responses to Influenza. Lauring AS, editor. PLOS Pathog. Public Library of Science; 2016;12: e1005692. doi:<a href="https://doi.org/10.1371/journal.ppat.1005692">10.1371/journal.ppat.1005692</a></p>
</div>
<div id="ref-li2013">
<p>10. Li Y, Myers JL, Bostick DL, Sullivan CB, Madara J, Linderman SL, et al. Immune history shapes specificity of pandemic H1N1 influenza antibody responses. J Exp Med. 2013;210. doi:<a href="https://doi.org/10.1084/jem.20130212">10.1084/jem.20130212</a></p>
</div>
<div id="ref-linderman2014">
<p>11. Linderman SL, Chambers BS, Zost SJ, Parkhouse K, Li Y, Herrmann C, et al. Potential antigenic explanation for atypical H1N1 infections among middle-aged adults during the 2013-2014 influenza season. Proc Natl Acad Sci U S A. 2014;111: 15798–15803. doi:<a href="https://doi.org/10.1073/pnas.1409171111">10.1073/pnas.1409171111</a></p>
</div>
<div id="ref-gostic2016">
<p>12. Gostic KM, Ambrose M, Worobey M, Lloyd-Smith JO. Potent protection against H5N1 and H7N9 influenza via childhood hemagglutinin imprinting. Science. 2016;354: 722–726. doi:<a href="https://doi.org/10.1126/science.aag1322">10.1126/science.aag1322</a></p>
</div>
<div id="ref-cobey2017">
<p>13. Cobey S, Hensley SE. Immune history and influenza virus susceptibility. Curr Opin Virol. 2017; doi:<a href="https://doi.org/10.1016/j.coviro.2016.12.004">10.1016/j.coviro.2016.12.004</a></p>
</div>
<div id="ref-monto2017">
<p>14. Monto AS, Malosh RE, Petrie JG, Martin ET. The Doctrine of Original Antigenic Sin: Separating Good From Evil. J Infect Dis. 2017;215: 1782–1788. doi:<a href="https://doi.org/10.1093/infdis/jix173">10.1093/infdis/jix173</a></p>
</div>
<div id="ref-kim2009">
<p>15. Kim JH, Skountzou I, Compans R, Jacob J. Original Antigenic Sin Responses to Influenza Viruses. J Immunol. 2009;183: 3294–3301. doi:<a href="https://doi.org/10.4049/jimmunol.0900398">10.4049/jimmunol.0900398</a></p>
</div>
<div id="ref-lessler2012">
<p>16. Lessler J, Riley S, Read JM, Wang S, Zhu H, Smith GJD, et al. Evidence for antigenic seniority in influenza A (H3N2) antibody responses in southern China. PLoS Pathog. Public Library of Science; 2012;8: e1002802. doi:<a href="https://doi.org/10.1371/journal.ppat.1002802">10.1371/journal.ppat.1002802</a></p>
</div>
<div id="ref-fonville2014">
<p>17. Fonville JM, Wilks SH, James SL, Fox A, Ventresca M, Aban M, et al. Antibody landscapes after influenza virus infection or vaccination. Science. 2014;346: 996–1000. doi:<a href="https://doi.org/10.1126/science.1256427">10.1126/science.1256427</a></p>
</div>
<div id="ref-monsterinhopping2016">
<p>18. Mosterín Höpping A, McElhaney J, Fonville JM, Powers DC, Beyer WEP, Smith DJ, et al. The confounded effects of age and exposure history in response to influenza vaccination. Vaccine. NIH Public Access; 2016;34: 540–546. doi:<a href="https://doi.org/10.1016/j.vaccine.2015.11.058">10.1016/j.vaccine.2015.11.058</a></p>
</div>
<div id="ref-kucharski2015">
<p>19. Kucharski AJ, Lessler J, Read JM, Zhu H, Jiang CQ, Guan Y, et al. Estimating the Life Course of Influenza A(H3N2) Antibody Responses from Cross-Sectional Data. PLoS Biol. Public Library of Science; 2015;13: 1–16. doi:<a href="https://doi.org/10.1371/journal.pbio.1002082">10.1371/journal.pbio.1002082</a></p>
</div>
<div id="ref-kucharski2018">
<p>20. Kucharski AJ, Lessler J, Cummings DAT, Riley S. Timescales of influenza a/h3n2 antibody dynamics. PLOS Biology. 2018;16: 1–19. doi:<a href="https://doi.org/10.1371/journal.pbio.2004974">10.1371/journal.pbio.2004974</a></p>
</div>
<div id="ref-smith2004">
<p>21. Smith DJ. Mapping the Antigenic and Genetic. 2004;305: 371–376. doi:<a href="https://doi.org/10.1126/science.1097211">10.1126/science.1097211</a></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
